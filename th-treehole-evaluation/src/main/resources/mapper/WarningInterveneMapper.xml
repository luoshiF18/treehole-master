<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.treehole.evaluation.dao.WarningInterveneMapper">
   <select id="findAllByInterveneRequest" parameterType="com.treehole.framework.domain.evaluation.request.InterveneRequest"
            resultType="com.treehole.framework.domain.evaluation.WarningIntervene">

      select
         i.user_name,
         i.advisory_name,
         i.record_time,
         w.warning_level,
         w.w_message
         from warning_intervene i
         left join warning  w on w.id=i.warning_id
         where
         1=1
      <if test="interveneRequest.startTime!= null and interveneRequest.endTime != null and
          interveneRequest.startTime!='' and  interveneRequest.endTime !=''">
         and
         record_time BETWEEN #{interveneRequest.startTime} and #{interveneRequest.endTime}
         </if>
      <if test="interveneRequest.userName != null and interveneRequest.userName !=''">
         AND
         i.user_name =#{interveneRequest.userName}
      </if>
      <if test="interveneRequest.advisoryName != null and interveneRequest.advisoryName !=''">
         AND
         i.advisory_name =#{interveneRequest.advisoryName}
      </if>

    </select>



</mapper>