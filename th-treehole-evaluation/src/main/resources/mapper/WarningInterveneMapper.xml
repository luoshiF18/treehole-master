<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.treehole.evaluation.dao.WarningInterveneMapper">
   <select id="getAllByInterveneRequest" parameterType="com.treehole.framework.domain.evaluation.request.InterveneRequest"
            resultType="com.treehole.framework.domain.evaluation.vo.WarnInterveneVo">

      select
      id,
      user_name as userName,
      advisory_name as advisoryName,
      record_time as recordTime,
      status
      from warning_intervene
      where
      1=1
      <if test="interveneRequest.startTime!= null and interveneRequest.endTime != null and
          interveneRequest.startTime!='' and  interveneRequest.endTime !=''">
         and
         record_time BETWEEN #{interveneRequest.startTime} and #{interveneRequest.endTime}
         </if>
      <if test="interveneRequest.userNickName != null and interveneRequest.userNickName !=''">
         AND
         warning_intervene.user_name =#{interveneRequest.userNickName}
      </if>
      <if test="interveneRequest.advisoryName != null and interveneRequest.advisoryName !=''">
         AND
         warning_intervene.advisory_name =#{interveneRequest.advisoryName}
      </if>

    </select>

<select id="findWarnInterveneByName" resultType="com.treehole.framework.domain.evaluation.WarningIntervene">
    SELECT
     context,
     reason,
     effect,
     way,
     advisory_name as advisoryName,
     record_time as recordTime,
     user_name as userName
     FROM
     warning_intervene
     WHERE
     user_name=#{userName}
</select>

</mapper>